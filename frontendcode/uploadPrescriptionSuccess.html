<!doctype html>
<html class="no-js" lang="en">

    <head>
        <!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <!--font-family-->
		<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&amp;subset=devanagari,latin-ext" rel="stylesheet">
        
        <!-- title of site -->
        <title>Flipkart Health PLus</title>

        <!-- For favicon png -->
		<link rel="shortcut icon" type="image/icon" href="assets/logo/favicon.png"/>
       
        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="assets/css/font-awesome.min.css">

		<!--flat icon css-->
		<link rel="stylesheet" href="assets/css/flaticon.css">

		<!--animate.css-->
        <link rel="stylesheet" href="assets/css/animate.css">

        <!--owl.carousel.css-->
        <link rel="stylesheet" href="assets/css/owl.carousel.min.css">
		<link rel="stylesheet" href="assets/css/owl.theme.default.min.css">
		
        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">
		
		<!-- bootsnav -->
		<link rel="stylesheet" href="assets/css/bootsnav.css" >	
        
        <!--style.css-->
        <link rel="stylesheet" href="assets/css/style.css">
        
        <!--responsive.css-->
        <link rel="stylesheet" href="assets/css/responsive.css">
        
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		
        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>
	
	<body>
		<!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->
		
		<!-- top-area Start -->
		<header class="top-area">
			<div class="header-area">
				<!-- Start Navigation -->
			    <nav class="navbar navbar-default bootsnav navbar-fixed dark no-background">

			        <div class="container">

			            <!-- Start Header Navigation -->
			            <div class="navbar-header">
			                <a class="navbar-brand" href="index.html">PRESCRIPTION UPLOADED</a>
			            </div><!--/.navbar-header-->
			            <!-- End Header Navigation -->
                        

			            <!-- Collect the nav links, forms, and other content for toggling -->
			        </div><!--/.container-->
			    </nav><!--/nav-->
			    <!-- End Navigation -->
			</div><!--/.header-area-->

		    <div class="clearfix"></div>

		</header><!-- /.top-area-->
		<!-- top-area End -->
	
		<!--welcome-hero start -->
		<section id="welcome-hero" class="welcome-hero">
			<div class="container">
				<div class="row">
					<div class="col-md-12 text-center">
						<div class="header-text">
							<!-- <h2>hi <span>,</span> i am  your <br> health <br> advocate <span>.</span>   </h2> -->
							<!-- <p>What </p> -->
							<!--<a href="assets/download/browney.txt" download>Upload Prescription</a>-->
								<!-- <button type="submit" onclick="submitForm()">Upload Prescription</button>
                                <button type="submit" onclick="submitForm()">Upload Prescription</button> -->
								<!-- <button type="submit" onclick="submitForm()">View Cart</button> -->
                            <div id="apiResponseContainer">
                                <p id="text"></p>
                            </div>
                            <form action="/action_page.php">
                                <br>
                                <label for="cars">Choose a language:</label>
                                <select name="languages" id="languages">
                                 <option value="en">English</option>
                                 <option value="gu">Gujarati</option>
                                  <option value="hi">Hindi</option>
                                  <option value="kn">Kannada</option>
                                  <option value="ml">Malayalam</option>
                                  <option value="pa">Punjabi</option>
                                  <option value="es">Spanish</option>
                                  <option value="ta">Tamil</option>
                                  <option value="te">Telugu</option>
                                  <!-- <option value="marathi">Marathi</option>
                                  <option value="tamil">Tamil</option> -->
                                </select>
                                <br><br>
                                <!-- <button type="submit" style="display:none" onclick="getResponse()">Submit</button> -->
                              </form>
                              <audio controls id="audioPlayer">
                                <source id="audioSource" type="audio/ogg">
                                Your browser does not support the audio element.
                              </audio>
                              <script>
                                function updateAudioFile(text, lan) {
                                    // Create a FormData object to hold the data to be sent
                                    var id = lan + (Math.floor(Math.random() * (999999 - 1)) + 1).toString()+".mp3";
                                    console.log("text for audio:", text);
                                    console.log("lang for audio:", lan);
                                    var requestData = {
                                        text: text,
                                        lang: lan,
                                        fileName: id
                                    };

                                    fetch('http://127.0.0.1:5000/audio', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(requestData) 
                                    })
                                    .then(response => {
                                        console.log("Response is: ", response);
                                        if (!response.ok) {
                                            throw new Error('Failed to submit form');
                                        }
                                        return response.json();
                                    })
                                    .then(data => {
                                        // Handle the success response, for example, store the response data
                                        var audioPlayer = document.getElementById('audioPlayer');
                                        var audioSource = document.getElementById('audioSource');
                                        audioSource.src = data.fileName
                                        audioPlayer.load();
                                        console.log("audioResponse ",  JSON.stringify(data));
                                        console.log('Form submitted successfully');
                                    })
                                    .catch(error => {
                                        console.error('Error:', error);
                                        // Handle error, display error message, etc.
                                    });
                                }
                            </script>
                            <script>
                                // Retrieve the apiResponse from localStorage and parse it as JSON
                                var apiResponse = JSON.parse(localStorage.getItem('apiResponse'));
								console.log("Api response is:",apiResponse);
                        
                                // Create a new paragraph element
                                var paragraph = document.getElementById('text');
                        
                                // Set the inner HTML of the paragraph to the apiResponse
                                paragraph.innerHTML = apiResponse.text;

                                var link = document.createElement('a');

                                // Set the href attribute of the anchor element to the value from the API response
                                //link.href = apiResponse.href;
                                link.href = apiResponse.link;

                                // Set the text content of the anchor element
                                link.textContent = 'View Cart';
                        
                                // Append the paragraph to the container element
                                document.getElementById('apiResponseContainer').appendChild(paragraph);
                                document.getElementById('apiResponseContainer').appendChild(link);
                                var paragraph = document.getElementById('text');
                                updateAudioFile(paragraph.textContent,"en");
                            </script>

                            <script>
                                document.getElementById('languages').addEventListener('change', function() {
                                var selectedValue = this.value;
                                console.log("Selected Value:", selectedValue);
                                //var paragraph = document.getElementById('text');
                                translateText(selectedValue)
                                //paragraph.innerHTML = JSON.parse(localStorage.getItem('translateResponse')).translatedText;
                                console.log("paragraph.innerHTML ", paragraph.innerHTML);
                                console.log("translateResponse ",  JSON.parse(localStorage.getItem('translateResponse')).translatedText);
                                console.log("Selected Value:", selectedValue);
    
                                });
                                function translateText(dest_lan) {
                                    // Create a FormData object to hold the data to be sent
                                    var text = JSON.parse(localStorage.getItem('apiResponse')).text;
                                    var src_lan = "en";

                                    var requestData = {
                                        text: text,
                                        src: src_lan,
                                        dest: dest_lan
                                    };

                                    fetch('http://127.0.0.1:5000/translate', {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(requestData) 
                                    })
                                    .then(response => {
                                        console.log("Response is: ", response);
                                        if (!response.ok) {
                                            throw new Error('Failed to submit form');
                                        }
                                        return response.json();
                                    })
                                    .then(data => {
                                        // Handle the success response, for example, store the response data
                                        localStorage.setItem('translateResponse', JSON.stringify(data));
                                        var paragraph = document.getElementById('text');
                                        paragraph.innerHTML = data.translatedText;
                                        console.log("translateResponse ",  JSON.stringify(data));
                                        console.log('Form submitted successfully');
                                        updateAudioFile(data.translatedText,dest_lan);
                                    })
                                    .catch(error => {
                                        console.error('Error:', error);
                                        // Handle error, display error message, etc.
                                    });
                                }

                            </script>
                            <!-- <a href="cartPage.html">View Cart</a> -->
						</div><!--/.header-text-->
					</div><!--/.col-->
				</div><!-- /.row-->
			</div><!-- /.container-->

		</section><!--/.welcome-hero-->
		<!--welcome-hero end -->

		
		<!-- Include all js compiled plugins (below), or include individual files as needed -->

		<script src="assets/js/jquery.js"></script>
        
        <!--modernizr.min.js-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
		
		<!--bootstrap.min.js-->
        <script src="assets/js/bootstrap.min.js"></script>
		
		<!-- bootsnav js -->
		<script src="assets/js/bootsnav.js"></script>
		
		<!-- jquery.sticky.js -->
		<script src="assets/js/jquery.sticky.js"></script>
		
		<!-- for progress bar start-->

		<!-- progressbar js -->
		<script src="assets/js/progressbar.js"></script>

		<!-- appear js -->
		<script src="assets/js/jquery.appear.js"></script>

		<!-- for progress bar end -->

		<!--owl.carousel.js-->
        <script src="assets/js/owl.carousel.min.js"></script>


		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
		
        
        <!--Custom JS-->
        <script src="assets/js/custom.js"></script>
        
    </body>
	
</html>
